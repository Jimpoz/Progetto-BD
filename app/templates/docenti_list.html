<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="../static/student.css">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Area Studente</title>
</head>

<body>

    <ul>
        <li><a href="{{ url_for('routes.homepage') }}">Homepage</a></li>
        <li><a href="{{ url_for('routes.create_exam') }}">Crea esame</a></li>
        <li><a href="{{ url_for('routes.view_exams') }}">Lista esami</a></li>
        <li style="float:right"><a href="{{ url_for('routes.login') }}">Logout</a></li>
    </ul>

    <div id="Docente" class="w3-container">
        <h1>Lista Docenti</h1>
    </div>
    <br>
    <div id="Lista_docenti" style="position: relative;">
        {% for docente in lista_docenti %}
            <div class="student-info" onclick="addRow('{{ docente.idD }}', '{{ esame.idE }}')" style="cursor: pointer;">
                <p>ID: {{ docente.idD }}</p>
                <p>Nome: {{ docente.nome }}</p>
                <p>Cognome: {{ docente.cognome }}</p>
                {% for ruolo in lista_ruoli %}
                    {% if ruolo[0] == docente.idD %}
                        <p>Ruolo: {{ ruolo[1] }}</p>
                    {% endif %}
                {% endfor %}
            </div>
        {% endfor %}
    </div>
    
    

    <script>
        function addRow(docenteId, examId) {
            // Create the request body
            var requestBody = {
                docenteId: docenteId,
                examId: examId
            };
        
            // Send a POST request to the server to add the row
            fetch('/add_row', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(requestBody)
            })
            .then(response => response.json())
            .then(data => {
                // Handle the response if needed
                console.log(data);
                // Add the row to the table on success
                if (data.message === 'Row added successfully') {
                    addTableRow(docenteId, examId, 'Membro');
                    // Redirect to the exam_page.html with the examId parameter
                    // window.location.href = '/exam_page?examId=' + examId;
                }
            })
            .catch(error => {
                console.log('Error:', error);
            });
        }
        
    
        function addTableRow(docenteId, examId, ruolo) {
            // Create a new row
            var newRow = document.createElement('tr');
            // Create cells for the row
            var idCell = document.createElement('td');
            idCell.textContent = docenteId;
            var examIdCell = document.createElement('td');
            examIdCell.textContent = examId;
            var ruoloCell = document.createElement('td');
            ruoloCell.textContent = ruolo;
            // Append cells to the row
            newRow.appendChild(idCell);
            newRow.appendChild(examIdCell);
            newRow.appendChild(ruoloCell);
            // Append the row to the table body
            var tableBody = document.getElementById('membro_table_body');
            tableBody.appendChild(newRow);
        }
    </script>
    
</body>

</html>